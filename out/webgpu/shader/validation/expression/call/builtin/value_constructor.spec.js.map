{"version":3,"file":"value_constructor.spec.js","names":["description","makeTestGroup","keysOf","isConvertible","MatrixType","scalarTypeOf","Type","VectorType","ShaderValidationTest","g","kScalarTypes","test","desc","params","u","combine","beforeAllSubcases","t","type","selectDeviceOrSkipTestCase","fn","enable","code","expectCompileResult","value_type","includes","beginSubcases","abstract","param","decl","size","comparison","i","unimplemented","ty","eleTy","ele_type","requiresF16","eleValue","create","wgsl","valueCall","full_type","num_eles","width","expect","v","call","cols","rows","c","r","kArrayCases","i32","element","valid","values","f32","u32","valid_array","invalid_rta","invalid_override_array","valid_struct","invalid_struct","invalid_atomic","testcase","case","kStructCases","name","decls","f32x2","vec3u","runtime_array","atomic","struct","many_members"],"sources":["../../../../../../../src/webgpu/shader/validation/expression/call/builtin/value_constructor.spec.ts"],"sourcesContent":["export const description = `\nValidation tests for constructor built-in functions.\n`;\n\nimport { makeTestGroup } from '../../../../../../common/framework/test_group.js';\nimport { keysOf } from '../../../../../../common/util/data_tables.js';\nimport {\n  isConvertible,\n  MatrixType,\n  scalarTypeOf,\n  Type,\n  VectorType,\n} from '../../../../../util/conversion.js';\nimport { ShaderValidationTest } from '../../../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kScalarTypes = ['bool', 'i32', 'u32', 'f32', 'f16'];\n\ng.test('scalar_zero_value')\n  .desc('Tests zero value scalar constructors')\n  .params(u => u.combine('type', kScalarTypes))\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const enable = t.params.type === 'f16' ? 'enable f16;' : '';\n    const code = `${enable}\n    const x : ${t.params.type} = ${t.params.type}();\n    const_assert x == ${t.params.type}(0);`;\n    t.expectCompileResult(true, code);\n  });\n\ng.test('scalar_value')\n  .desc('Tests scalar value constructors')\n  .params(u =>\n    u\n      .combine('type', kScalarTypes)\n      .combine('value_type', [...kScalarTypes, 'vec2u', 'S', 'array<u32, 2>'])\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16' || t.params.value_type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const enable = t.params.type === 'f16' || t.params.value_type === 'f16' ? 'enable f16;' : '';\n    const code = `${enable}\n    const x : ${t.params.type} = ${t.params.type}(${t.params.value_type}());`;\n    t.expectCompileResult(kScalarTypes.includes(t.params.value_type), code);\n  });\n\ng.test('vector_zero_value')\n  .desc('Tests zero value vector constructors')\n  .params(u =>\n    u\n      .combine('type', [...kScalarTypes, 'abstract-int', 'abstract-float'] as const)\n      .beginSubcases()\n      .combine('size', [2, 3, 4] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const abstract = t.params.type === 'abstract-int' || t.params.type === 'abstract-float';\n    const param = abstract ? '' : `<${t.params.type}>`;\n    const decl = `vec${t.params.size}${param}`;\n    const enable = t.params.type === 'f16' ? 'enable f16;' : '';\n    const comparison = abstract ? '0' : `${t.params.type}(0)`;\n    let code = `${enable}\n    const x ${abstract ? '' : `: ${decl}`} = ${decl}();\\n`;\n    for (let i = 0; i < t.params.size; i++) {\n      code += `const_assert x[${i}] == ${comparison};\\n`;\n    }\n    t.expectCompileResult(true, code);\n  });\n\ng.test('vector_splat').unimplemented();\n\ng.test('vector_copy').unimplemented();\n\ng.test('vector_elementwise')\n  .desc('Test element-wise vector constructors')\n  .params(u =>\n    u\n      .combine('type', [\n        'bool',\n        'i32',\n        'u32',\n        'f32',\n        'f16',\n        'abstract-int',\n        'abstract-float',\n      ] as const)\n      .combine('ele_type', [\n        'bool',\n        'i32',\n        'u32',\n        'f32',\n        'f16',\n        'abstract-int',\n        'abstract-float',\n        'mat2x2f',\n        'mat3x3h',\n        'vec2i',\n        'vec3f',\n      ] as const)\n      .beginSubcases()\n      .combine('size', [2, 3, 4] as const)\n      .combine('num_eles', [2, 3, 4, 5] as const)\n      .combine('full_type', [true, false] as const)\n  )\n  .beforeAllSubcases(t => {\n    const ty = Type[t.params.type];\n    const eleTy = Type[t.params.ele_type];\n    if (ty.requiresF16() || eleTy.requiresF16()) {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const eleTy = Type[t.params.ele_type];\n    const abstract = t.params.type === 'abstract-int' || t.params.type === 'abstract-float';\n    const param = abstract ? '' : `<${t.params.type}>`;\n    const decl = `vec${t.params.size}${param}`;\n    const enable = t.params.type === 'f16' || t.params.ele_type === 'f16' ? 'enable f16;' : '';\n    const eleValue = eleTy.create(1).wgsl();\n    const valueCall = t.params.full_type ? decl : `vec${t.params.size}`;\n    let code = `${enable}\n    const x ${abstract ? '' : `: ${decl}`} = ${valueCall}(`;\n    for (let i = 0; i < t.params.num_eles; i++) {\n      code += `${eleValue},`;\n    }\n    code += `);`;\n    const ty = Type[t.params.type];\n    // WGSL requires:\n    // * number of elements match\n    // * element types match (or auto convert, vector special case)\n    //   * abstract decl works because it is untyped and inferred as a different type\n    const num_eles =\n      eleTy instanceof VectorType ? t.params.num_eles * eleTy.width : t.params.num_eles;\n    const expect =\n      !(eleTy instanceof MatrixType) &&\n      t.params.size === num_eles &&\n      (isConvertible(scalarTypeOf(eleTy), ty) ||\n        t.params.type === 'abstract-int' ||\n        t.params.type === 'abstract-float');\n    t.expectCompileResult(expect, code);\n  });\n\ng.test('vector_mixed')\n  .desc('Test vector constructors with mixed elements and vectors')\n  .params(u =>\n    u\n      .combine('type', [\n        'bool',\n        'i32',\n        'u32',\n        'f32',\n        'f16',\n        'abstract-int',\n        'abstract-float',\n      ] as const)\n      .combine('ele_type', [\n        'bool',\n        'i32',\n        'u32',\n        'f32',\n        'f16',\n        'abstract-int',\n        'abstract-float',\n      ] as const)\n      .beginSubcases()\n      .combine('size', [3, 4] as const)\n      .combine('num_eles', [3, 4, 5] as const)\n      .combine('full_type', [true, false] as const)\n  )\n  .beforeAllSubcases(t => {\n    const ty = Type[t.params.type];\n    const eleTy = Type[t.params.ele_type];\n    if (ty.requiresF16() || eleTy.requiresF16()) {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const eleTy = Type[t.params.ele_type];\n    const abstract = t.params.type === 'abstract-int' || t.params.type === 'abstract-float';\n    const param = abstract ? '' : `<${t.params.type}>`;\n    const decl = `vec${t.params.size}${param}`;\n    const enable = t.params.type === 'f16' || t.params.ele_type === 'f16' ? 'enable f16;' : '';\n    const v = eleTy.create(1).wgsl();\n    const call = t.params.full_type ? decl : `vec${t.params.size}`;\n    let code = `${enable}\\n`;\n\n    switch (t.params.num_eles) {\n      case 3:\n        code += `const x1 ${abstract ? '' : `: ${decl}`} = ${call}(${v}, vec2(${v}, ${v}));\\n`;\n        code += `const x2 ${abstract ? '' : `: ${decl}`} = ${call}(vec2(${v}, ${v}), ${v});\\n`;\n        break;\n      case 4:\n        code += `const x1 ${\n          abstract ? '' : `: ${decl}`\n        } = ${call}(${v}, vec2(${v}, ${v}), ${v});\\n`;\n        code += `const x2 ${\n          abstract ? '' : `: ${decl}`\n        } = ${call}(${v}, ${v}, vec2(${v}, ${v}));\\n`;\n        code += `const x3 ${\n          abstract ? '' : `: ${decl}`\n        } = ${call}(vec2(${v}, ${v}), ${v}, ${v});\\n`;\n        code += `const x4 ${\n          abstract ? '' : `: ${decl}`\n        } = ${call}(vec3(${v}, ${v}, ${v}), ${v});\\n`;\n        code += `const x5 ${\n          abstract ? '' : `: ${decl}`\n        } = ${call}(${v}, vec3(${v}, ${v}, ${v}));\\n`;\n        break;\n      case 5:\n        // This case is always invalid so try a few only.\n        code += `const x1 ${\n          abstract ? '' : `: ${decl}`\n        } = ${call}(${v}, vec3(${v}, ${v}), ${v});\\n`;\n        code += `const x1 ${abstract ? '' : `: ${decl}`} = ${call}(${v}, vec4(${v}}), ${v});\\n`;\n        break;\n    }\n    const ty = Type[t.params.type];\n    // WGSL requires:\n    // * number of elements match (in total, not parameters)\n    // * element types match (or auto convert)\n    //   * abstract decl works because it is untyped and inferred as a different type\n    const expect =\n      t.params.size === t.params.num_eles &&\n      (isConvertible(eleTy, ty) ||\n        t.params.type === 'abstract-int' ||\n        t.params.type === 'abstract-float');\n    t.expectCompileResult(expect, code);\n  });\n\ng.test('matrix_zero_value')\n  .desc('Tests zero value matrix constructors')\n  .params(u =>\n    u\n      .combine('type', ['f32', 'f16'] as const)\n      .beginSubcases()\n      .combine('rows', [2, 3, 4] as const)\n      .combine('cols', [2, 3, 4] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(t => {\n    const decl = `mat${t.params.cols}x${t.params.rows}<${t.params.type}>`;\n    const enable = t.params.type === 'f16' ? 'enable f16;' : '';\n    let code = `${enable}\n    const x : ${decl} = ${decl}();\\n`;\n    for (let c = 0; c < t.params.cols; c++) {\n      for (let r = 0; r < t.params.rows; r++) {\n        code += `const_assert x[${c}][${r}] == ${t.params.type}(0);\\n`;\n      }\n    }\n    t.expectCompileResult(true, code);\n  });\n\ng.test('matrix_copy').unimplemented();\n\ng.test('matrix_column').unimplemented();\n\ng.test('matrix_elementwise').unimplemented();\n\ninterface ArrayCase {\n  element: string;\n  size: number | string;\n  valid: boolean;\n  values: string;\n}\n\nconst kArrayCases: Record<string, ArrayCase> = {\n  i32: {\n    element: 'i32',\n    size: 4,\n    valid: true,\n    values: '1,2,3,4',\n  },\n  f32: {\n    element: 'f32',\n    size: 1,\n    valid: true,\n    values: '0',\n  },\n  u32: {\n    element: 'u32',\n    size: 2,\n    valid: true,\n    values: '2,4',\n  },\n  valid_array: {\n    element: 'array<u32, 2>',\n    size: 2,\n    valid: true,\n    values: 'array(0,1), array(2,3)',\n  },\n  invalid_rta: {\n    element: 'u32',\n    size: '',\n    valid: false,\n    values: '0',\n  },\n  invalid_override_array: {\n    element: 'u32',\n    size: 'o',\n    valid: false,\n    values: '1',\n  },\n  valid_struct: {\n    element: 'valid_S',\n    size: 1,\n    valid: true,\n    values: 'valid_S(0)',\n  },\n  invalid_struct: {\n    element: 'invalid_S',\n    size: 1,\n    valid: false,\n    values: 'array(0)',\n  },\n  invalid_atomic: {\n    element: 'atomic<u32>',\n    size: 1,\n    valid: false,\n    values: '0',\n  },\n};\n\ng.test('array_zero_value')\n  .desc('Tests zero value array constructors')\n  .params(u => u.combine('case', keysOf(kArrayCases)))\n  .fn(t => {\n    const testcase = kArrayCases[t.params.case];\n    const decl = `array<${testcase.element}, ${testcase.size}>`;\n    const code = `override o : i32 = 1;\n    struct valid_S {\n      x : u32\n    }\n    struct invalid_S {\n      x : array<u32>\n    }\n    const x : ${decl} = ${decl}();`;\n    t.expectCompileResult(testcase.valid, code);\n  });\n\ng.test('array_value')\n  .desc('Tests array value constructor')\n  .params(u => u.combine('case', keysOf(kArrayCases)))\n  .fn(t => {\n    const testcase = kArrayCases[t.params.case];\n    const decl = `array<${testcase.element}, ${testcase.size}>`;\n    const code = `override o : i32 = 1;\n    struct valid_S {\n      x : u32\n    }\n    struct invalid_S {\n      x : array<u32>\n    }\n    const x : ${decl} = ${decl}(${testcase.values});`;\n    t.expectCompileResult(testcase.valid, code);\n  });\n\nconst kStructCases = {\n  i32: {\n    name: 'S',\n    decls: `struct S { x : u32 }`,\n    valid: true,\n    values: '0',\n  },\n  f32x2: {\n    name: 'S',\n    decls: `struct S { x : f32, y : f32 }`,\n    valid: true,\n    values: '0,1',\n  },\n  vec3u: {\n    name: 'S',\n    decls: `struct S { x : vec3u }`,\n    valid: true,\n    values: 'vec3()',\n  },\n  valid_array: {\n    name: 'S',\n    decls: `struct S { x : array<u32, 2> }`,\n    valid: true,\n    values: 'array(1,2)',\n  },\n  runtime_array: {\n    name: 'S',\n    decls: `struct S { x : array<u32> }`,\n    valid: false,\n    values: 'array(0)',\n  },\n  atomic: {\n    name: 'S',\n    decls: `struct S { x : atomic<u32> }`,\n    valid: false,\n    values: '0',\n  },\n  struct: {\n    name: 'S',\n    decls: `struct S {\n      x : T\n    }\n    struct T {\n      x : u32\n    }`,\n    valid: true,\n    values: 'T(0)',\n  },\n  many_members: {\n    name: 'S',\n    decls: `struct S {\n      a : bool,\n      b : u32,\n      c : i32,\n      d : vec4f,\n    }`,\n    valid: true,\n    values: 'false, 1u, 32i, vec4f(1.0f)',\n  },\n};\n\ng.test('struct_zero_value')\n  .desc('Tests zero value struct constructors')\n  .params(u => u.combine('case', keysOf(kStructCases)))\n  .fn(t => {\n    const testcase = kStructCases[t.params.case];\n    const code = `\n    ${testcase.decls}\n    const x : ${testcase.name} = ${testcase.name}();`;\n    t.expectCompileResult(testcase.valid, code);\n  });\n\ng.test('struct_value')\n  .desc('Tests struct value constructors')\n  .params(u => u.combine('case', keysOf(kStructCases)))\n  .fn(t => {\n    const testcase = kStructCases[t.params.case];\n    const code = `\n    ${testcase.decls}\n    const x : ${testcase.name} = ${testcase.name}(${testcase.values});`;\n    t.expectCompileResult(testcase.valid, code);\n  });\n"],"mappings":"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"}